# üß† AI-Report Backend

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º—É–ª—å—Ç–∏–º–µ–¥–∏–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Kafka, S3, –∏ LLM (—á–µ—Ä–µ–∑ Ollama).

## ‚öôÔ∏è –°–æ—Å—Ç–∞–≤

- **Kafka Consumer**: —á–∏—Ç–∞–µ—Ç –∑–∞–¥–∞—á–∏ –∏–∑ —Ç–æ–ø–∏–∫–∞ (`task`)
- **Kafka Producer**: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `callback`-—Ç–æ–ø–∏–∫
- **S3**: —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- **Ollama**: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM
- **Hugging Face**: (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π
- **ProtoBuf**: –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–°–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**:

```bash
python -m venv .venv
source .venv/bin/activate  # Linux/macOS
.venv\Scripts\activate     # Windows
```

2.	–£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```
pip install -r requirements.txt
```

3.	–ù–∞—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

–°–æ–∑–¥–∞–π .env —Ñ–∞–π–ª –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã:

```
KAFKA_GROUP_ID=python-consumer
KAFKA_BROKER_1 = localhost:9092

HF_TOKEN=token
OLLAMA_URL=0.0.0.0:11434
OLLAMA_MODEL=llama3.3
OLLAMA_NUM_CONTEXT=2048

AWS_ACCESS_KEY_ID = log
AWS_SECRET_ACCESS_KEY = pass
S3_ENDPOINT_URL = http://localhost:9000
S3_BUCKET_NAME = bicket
S3_PUBLIC_BASE_URL= localhost:9000
AWS_REGION = ru-1
```
4.	–°–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–π YAML (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

–§–∞–π–ª app/config/config.yaml –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω.
5.	–ó–∞–ø—É—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç:

```
make run
```

‚∏ª

üß™ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:

```
make lint     # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ flake8
make format   # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ black + isort
```

‚∏ª

üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
app/
‚îú‚îÄ‚îÄ client/           # –†–∞–±–æ—Ç–∞ —Å S3
‚îú‚îÄ‚îÄ config/           # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ generated/        # gRPC / protobuf —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ handlers/         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–¥–∞—á (convert, diarize, ...)
‚îú‚îÄ‚îÄ kafka/            # Kafka consumer / producer
‚îú‚îÄ‚îÄ utils/            # –õ–æ–≥–≥–µ—Ä, –∑–∞–ø—É—Å–∫
‚îî‚îÄ‚îÄ main.py           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

‚∏ª

üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è<br />
	‚Ä¢	Kafka offset –∫–æ–º–º–∏—Ç–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.<br />
	‚Ä¢	–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è protobuf –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á.<br />
	‚Ä¢	–ì–µ–Ω–µ—Ä–∞—Ü–∏—è .proto —Ñ–∞–π–ª–æ–≤:<br />

```
make generate
```

‚∏ª

üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT